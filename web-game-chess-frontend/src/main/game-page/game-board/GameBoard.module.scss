@import "../../Main.scss";

.board-container {
  @include wh100();
  @include flex();

  position: relative;
  z-index: 0;
  border-radius: $lg-br;
  box-shadow:
    inset 2rem 0 2rem -1rem rgba($mc5, 0.3),
    inset -2rem 0 2rem -1rem rgba($mc5, 0.3),
    inset 0 1rem 2rem -1rem rgba($mc5, 0.3),
    inset 0 -1rem 2rem -1rem rgba($mc5, 0.3);

  .board {
    @include square(64rem);
    @include rounded(2rem);

    position: inherit;
    z-index: 10;
    background-color: #000;
    overflow: hidden;

    // files indicators
    @mixin filesIndicators() {
      position: absolute;
      display: grid;
      background-color: #000;

      div {
        @include flex();

        font-size: 1.2rem;
        font-weight: bold;
        color: $gc5;
      }
    }

    .white-indicators {
      transform: rotate(0deg);
      div {
        transform: rotate(0deg);
      }
    }

    .black-indicators {
      transform: rotate(180deg);
      div {
        transform: rotate(180deg);
      }
    }

    &__rows {
      @include filesIndicators();

      top: 2rem;
      left: 0;
      width: 2rem;
      height: calc(100% - 2 * 2rem);
      grid-template-rows: repeat(8, 1fr);
    }

    &__columns {
      @include filesIndicators();

      bottom: 0;
      left: 2rem;
      width: calc(100% - 2 * 2rem);
      height: 2rem;
      grid-template-columns: repeat(8, 1fr);
    }
    // end files indicators

    &__content {
      @include wh100();
      position: relative;

      @mixin board() {
        @include wh100();

        position: relative;
        aspect-ratio: 1/1;
        display: grid;
        grid-template-rows: repeat(8, 1fr);
        overflow: hidden;
      }

      &__inner {
        @include board();

        z-index: 10;
        grid-template-columns: repeat(8, 1fr) 0;
        border-radius: 1rem;
        background-image: url("/icons/wood.png");
        background-size: 12.5% 12.5%;

        .inner-field {
          @include flex();

          position: relative;
          z-index: 10;
          aspect-ratio: 1/1;

          &:nth-child(odd) {
            background-color: rgba($mc0, 0.96);
          }
          &:nth-child(even) {
            background-color: rgba($mc9, 0.96);
          }
        }

        .placeholder {
          width: 0;
        }
      }

      // grid board
      &__grid {
        @include board();

        position: absolute;
        top: 0;
        left: 0;
        z-index: 11;
        grid-template-columns: repeat(8, 1fr);

        .field {
          @include flex();

          position: relative;
          z-index: 10;
          aspect-ratio: 1/1;

          &:hover {
            filter: brightness(90%);
          }

          &:nth-child(odd) {
            &.old {
              background-color: rgba($mc3, 0.96);
            }
            &.new {
              background-color: rgba($mc3, 0.96);
            }
          }
          &:nth-child(even) {
            &.old {
              background-color: rgba($mc4, 0.96);
            }
            &.new {
              background-color: rgba($mc4, 0.96);
            }
          }

          &.highlight {
            background-color: rgba($danger-color-l, 0.96);
          }

          &.tip {
            cursor: pointer;
            background-image: radial-gradient(
              circle at 50% 50%,
              rgba(#000, 0.5) 30%,
              #0000 40%
            );

            &:not(.selected) {
              &:has(.piece) {
                img {
                  filter: drop-shadow(0 0 1rem $danger-color-m);
                }
              }
            }
          }

          &.selected {
            .piece {
              img {
                filter: drop-shadow(0 0 1rem #000) brightness(60%);
              }
            }
          }

          .piece {
            @include square(100%);
            @include flex();

            user-select: none;
            transition: transform 0.1s;

            img {
              height: calc(((64rem - 2rem) / 8) * 0.8);
              transform: translateZ(-1px);
              filter: drop-shadow(0 0 1rem #000);
              pointer-events: none;
            }

            .x {
              position: absolute;
              top: 0;
              right: 0;
              height: 3rem;
            }
          }
        }

        .check {
          background-image: radial-gradient(
            circle at 50% 50%,
            $danger-color-d 30%,
            $danger-color-m 50%,
            $danger-color-l 70%,
            #0000 100%
          );
        }
      }
    }

    .white-board {
      transform: rotate(0deg);

      .field {
        transform: rotate(0deg);
      }
    }

    .black-board {
      transform: rotate(180deg);

      .field {
        transform: rotate(180deg);
      }
    }
    // end grid board

    &__promotion {
      @include absCenter();
      @include wh100();

      z-index: 100;
      background-color: rgba(#000, 0.7);

      &__pieces {
        @include absCenter();
        @include flex();
        @include rounded(1rem);

        background-color: $gc9;
        border: solid 0.5rem $gc8;

        .piece {
          @include rounded(1rem);

          &:hover {
            cursor: pointer;
            background-color: rgba(#000, 0.5);
          }

          img {
            height: 6rem;
          }
        }
      }
    }
  }
}
